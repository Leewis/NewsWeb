@inherits Umbraco.Web.Macros.PartialViewMacroPage
@using Umbraco.Core.Mapping;
@using NewsWeb.Services
@{
    var currentPage = Model.Content;
    var category = Umbraco.Content(Udi.Parse(Model.MacroParameters["category"].ToString()));
    var arrayNews = category.Descendants().Where(x => x.IsVisible() && x.ContentType.Alias == "news").OrderByDescending(item => item.Value("postedDateTime")).ToArray();

    var news = category.Descendants().Where(x => x.IsVisible() && x.ContentType.Alias == "news" && (bool)(x.GetProperty("showInTopicList").Value()) == true).OrderByDescending(item => item.Value("postedDateTime"));
    UmbracoMapper mapper = new UmbracoMapper(new MapDefinitionCollection(new List<IMapDefinition>()));
    INewsService service = new NewsService(mapper);
    var categoryData = service.GetCategory(news);
    var maxItem = 5;
    //int.TryParse(Model.MacroParameters["numbersNews"].ToString(), out maxItem);
}

<div class="topic-list">
    <div class="row">
        @for (int i = 0; i < categoryData.Count(); i++)
        {
            if (i == maxItem) { break; }
            <div class="col-lg col-md-4 topic-item">
                <a href="#" class="d-inline-block img-thumb"><img src="@categoryData[i].Picture" alt="news-kinh-doanh-1" class="img-fluid"></a>
                <h6 class="merri-title">
                    <a href="@categoryData[i].Url">
                        @categoryData[i].Title
                    </a>
                </h6>
                <p>
                    <span class="update-time">
                        <a href="#">Vĩ mô</a>
                    </span>
                    <span class="comments-count">
                        <i class="far fa-comment"></i>
                        <a href="#">32</a>
                    </span>
                </p>
            </div>

        }
    </div>
</div>
<div class="bt-solid mt-3 mb-3"></div>